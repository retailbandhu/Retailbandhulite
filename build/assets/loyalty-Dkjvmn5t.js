const m={enabled:!0,pointsPerRupee:1,redeemRate:.1,minPurchaseForPoints:50,minPointsToRedeem:100,bonusTiers:[{name:"Bronze",minSpend:0,bonusMultiplier:1,color:"#CD7F32"},{name:"Silver",minSpend:1e4,bonusMultiplier:1.25,color:"#C0C0C0"},{name:"Gold",minSpend:5e4,bonusMultiplier:1.5,color:"#FFD700"},{name:"Platinum",minSpend:1e5,bonusMultiplier:2,color:"#E5E4E2"}]};function p(e,t,n){if(!t.enabled||e<t.minPurchaseForPoints)return 0;const i=e/100*t.pointsPerRupee*n.bonusMultiplier;return Math.floor(i)}function c(e,t){const n=[...t.bonusTiers].sort((o,i)=>i.minSpend-o.minSpend);for(const o of n)if(e>=o.minSpend)return o;return t.bonusTiers[0]}function y(e,t){const n=[...t.bonusTiers].sort((r,l)=>r.minSpend-l.minSpend),o=n.findIndex(r=>r.name===e.name);if(o<0||o>=n.length-1)return null;const i=n[o+1];return{tier:i,amountNeeded:i.minSpend-e.minSpend}}const d="rb_loyalty_config",u="rb_customer_loyalty",s={getConfig:()=>{const e=localStorage.getItem(d);return e?JSON.parse(e):m},setConfig:e=>{localStorage.setItem(d,JSON.stringify(e))},getCustomerLoyalty:e=>{const t=localStorage.getItem(u);return t&&JSON.parse(t).find(o=>o.customerId===e)||null},getAllCustomerLoyalty:()=>{const e=localStorage.getItem(u);return e?JSON.parse(e):[]},updateCustomerLoyalty:e=>{const t=s.getAllCustomerLoyalty(),n=t.findIndex(o=>o.customerId===e.customerId);n>=0?t[n]=e:t.push(e),localStorage.setItem(u,JSON.stringify(t))},addPointsTransaction:(e,t)=>{const n=s.getCustomerLoyalty(e);if(!n)return;const o={...t,id:`pt_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};n.pointsHistory.unshift(o),t.type==="earned"||t.type==="bonus"?n.totalPoints+=t.points:t.type==="redeemed"&&(n.totalPoints-=t.points),s.updateCustomerLoyalty(n)}};function f(e,t,n,o){const i=s.getConfig();if(!i.enabled)return 0;let r=s.getCustomerLoyalty(e);r||(r={customerId:e,customerName:t,totalPoints:0,lifetimeSpend:0,currentTier:m.bonusTiers[0].name,pointsHistory:[]}),r.lifetimeSpend+=n;const l=c(r.lifetimeSpend,i);r.currentTier=l.name;const a=p(n,i,l);return a>0&&(r.totalPoints+=a,r.pointsHistory.unshift({id:`pt_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,date:new Date().toISOString(),type:"earned",points:a,description:`Earned from purchase of â‚¹${n}`,orderId:o}),s.updateCustomerLoyalty(r)),a}export{f as a,y as b,c as g,s as l};
