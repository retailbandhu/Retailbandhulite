import{c as I,r as h,t as x,j as d}from"./index-V23vquzg.js";import{M as T}from"./mic-DPZylqpl.js";import{S as $}from"./sparkles-BGdoZYCo.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],V=I("mic-off",F);function W(l={}){const{language:i="hi-IN",continuous:t=!1,interimResults:e=!0,onResult:n,onError:c,onEnd:o}=l,[s,a]=h.useState(!1),[f,m]=h.useState(!1),[u,k]=h.useState(""),[b,w]=h.useState(""),y=h.useRef(null);h.useEffect(()=>{const g=window.SpeechRecognition||window.webkitSpeechRecognition;m(!!g)},[]);const j=h.useCallback(()=>{const g=window.SpeechRecognition||window.webkitSpeechRecognition;if(!g){c?.("Speech recognition not supported in this browser");return}const r=new g;y.current=r,r.continuous=t,r.interimResults=e,r.lang=i,r.onstart=()=>{a(!0),k(""),w("")},r.onresult=p=>{let L="",S="";for(let C=p.resultIndex;C<p.results.length;C++){const R=p.results[C];R.isFinal?L+=R[0].transcript:S+=R[0].transcript}L&&(k(C=>C+L),n?.({transcript:L,confidence:p.results[p.results.length-1][0].confidence,isFinal:!0})),w(S),S&&n?.({transcript:S,confidence:0,isFinal:!1})},r.onerror=p=>{a(!1),c?.(p.error)},r.onend=()=>{a(!1),w(""),o?.()};try{r.start()}catch{c?.("Failed to start speech recognition")}},[i,t,e,n,c,o]),N=h.useCallback(()=>{y.current&&y.current.stop()},[]),M=h.useCallback(()=>{k(""),w("")},[]);return{isListening:s,isSupported:f,transcript:u,interimTranscript:b,startListening:j,stopListening:N,resetTranscript:M}}const v={ek:1,‡§è‡§ï:1,do:2,‡§¶‡•ã:2,teen:3,‡§§‡•Ä‡§®:3,char:4,‡§ö‡§æ‡§∞:4,panch:5,‡§™‡§æ‡§Ç‡§ö:5,chhah:6,‡§õ‡§π:6,saat:7,‡§∏‡§æ‡§§:7,aath:8,‡§Ü‡§†:8,nau:9,‡§®‡•å:9,das:10,‡§¶‡§∏:10,one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10};function A(l,i){const t=[],e=l.toLowerCase().trim(),n=[/(\d+|ek|do|teen|char|panch|chhah|saat|aath|nau|das|one|two|three|four|five|six|seven|eight|nine|ten)\s+(.+?)(?:\s+(?:aur|and|,)|$)/gi,/(.+?)\s+(\d+|ek|do|teen|char|panch|chhah|saat|aath|nau|das)\s+(?:piece|pieces|packet|packets)?/gi];for(const c of n){let o;for(;(o=c.exec(e))!==null;){let s,a;/^\d+$/.test(o[1])?(s=parseInt(o[1],10),a=o[2]):v[o[1].toLowerCase()]?(s=v[o[1].toLowerCase()],a=o[2]):(a=o[1],/^\d+$/.test(o[2])?s=parseInt(o[2],10):s=v[o[2].toLowerCase()]||1),a=a.replace(/\s*(aur|and|,)\s*$/,"").trim();const f=E(a,i);(f||a.length>1)&&t.push({productName:f?.name||a,quantity:s,matchedProduct:f})}}if(t.length===0&&e.length>1){const c=E(e,i);c&&t.push({productName:c.name,quantity:1,matchedProduct:c})}return t}function E(l,i){const t=l.toLowerCase().trim(),e=i.find(s=>s.name.toLowerCase()===t);if(e)return e;const n=i.find(s=>s.name.toLowerCase().startsWith(t)||t.startsWith(s.name.toLowerCase()));if(n)return n;const c=i.find(s=>s.name.toLowerCase().includes(t)||t.includes(s.name.toLowerCase()));return c||i.find(s=>{const a=s.name.toLowerCase().split(/\s+/);return t.split(/\s+/).some(m=>a.some(u=>u.includes(m)||m.includes(u)||P(u,m)<=2))})}function P(l,i){const t=[];for(let e=0;e<=i.length;e++)t[e]=[e];for(let e=0;e<=l.length;e++)t[0][e]=e;for(let e=1;e<=i.length;e++)for(let n=1;n<=l.length;n++)i.charAt(e-1)===l.charAt(n-1)?t[e][n]=t[e-1][n-1]:t[e][n]=Math.min(t[e-1][n-1]+1,t[e][n-1]+1,t[e-1][n]+1);return t[i.length][l.length]}function H({onVoiceInput:l,onParsedItems:i,products:t=[],size:e="lg",showBetaBadge:n=!0,language:c="hi-IN"}){const[o,s]=h.useState(!1),a=h.useCallback(r=>{if(r.isFinal&&r.transcript.trim()&&(l?.(r.transcript),t.length>0&&i)){const p=A(r.transcript,t);p.length>0&&i(p)}},[l,i,t]),f=h.useCallback(r=>{r==="not-allowed"?x.error("Microphone access denied. Please enable microphone in browser settings."):r==="no-speech"?x.info("No speech detected. Try speaking louder."):r==="network"?x.error("Network error. Check your internet connection."):x.error(`Voice error: ${r}`)},[]),m=h.useCallback(()=>{s(!1)},[]),{isListening:u,isSupported:k,transcript:b,interimTranscript:w,startListening:y,stopListening:j}=W({language:c,continuous:!1,interimResults:!0,onResult:a,onError:f,onEnd:m}),N=()=>{if(!k){x.error("Voice recognition is not supported in this browser. Try Chrome or Edge.");return}u?j():(s(!0),y(),x.info("üé§ Boliye... (Speak now)",{description:'Hindi/Hinglish mein bolo - "2 Maggi aur 1 Pepsi"'}))},M={sm:"w-10 h-10",md:"w-14 h-14",lg:"w-16 h-16"},g=b||w;return d.jsxs("div",{className:"relative inline-block",children:[d.jsx("button",{onClick:N,className:`${M[e]} rounded-full ${u?"bg-red-500 animate-pulse":"bg-gradient-to-r from-[#1E88E5] to-[#FF6F00]"} text-white shadow-lg hover:shadow-xl transition-all flex items-center justify-center`,title:u?"Listening... (Click to stop)":"Voice Input (Click to speak)",children:u?d.jsx(V,{className:`${e==="sm"?"w-5 h-5":e==="md"?"w-6 h-6":"w-8 h-8"}`}):d.jsx(T,{className:`${e==="sm"?"w-5 h-5":e==="md"?"w-6 h-6":"w-8 h-8"}`})}),n&&e==="lg"&&!u&&d.jsxs("div",{className:"absolute -top-1 -right-1 bg-gradient-to-r from-green-400 to-emerald-500 text-white text-xs px-2 py-0.5 rounded-full shadow-md flex items-center gap-1",children:[d.jsx($,{className:"w-3 h-3"}),d.jsx("span",{children:"LIVE"})]}),u&&d.jsxs("div",{className:"absolute -bottom-12 left-1/2 -translate-x-1/2 bg-white px-4 py-2 rounded-lg shadow-lg text-sm whitespace-nowrap min-w-[150px] text-center",children:[d.jsxs("div",{className:"flex items-center justify-center gap-2",children:[d.jsx("span",{className:"animate-pulse text-red-500",children:"‚óè"}),d.jsx("span",{children:"Sun raha hoon..."})]}),g&&d.jsxs("div",{className:"text-gray-600 text-xs mt-1 max-w-[200px] truncate",children:['"',g,'"']})]})]})}export{H as V};
